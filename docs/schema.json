{"name":"app","desc":"","tables":[{"name":"public._prisma_migrations","type":"BASE TABLE","comment":"","columns":[{"name":"id","type":"varchar(36)","nullable":false,"default":null,"comment":""},{"name":"checksum","type":"varchar(64)","nullable":false,"default":null,"comment":""},{"name":"finished_at","type":"timestamp with time zone","nullable":true,"default":null,"comment":""},{"name":"migration_name","type":"varchar(255)","nullable":false,"default":null,"comment":""},{"name":"logs","type":"text","nullable":true,"default":null,"comment":""},{"name":"rolled_back_at","type":"timestamp with time zone","nullable":true,"default":null,"comment":""},{"name":"started_at","type":"timestamp with time zone","nullable":false,"default":"now()","comment":""},{"name":"applied_steps_count","type":"integer","nullable":false,"default":"0","comment":""}],"indexes":[{"name":"_prisma_migrations_pkey","def":"CREATE UNIQUE INDEX _prisma_migrations_pkey ON public._prisma_migrations USING btree (id)","table":"public._prisma_migrations","columns":["id"],"comment":""}],"constraints":[{"name":"_prisma_migrations_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public._prisma_migrations","referenced_table":"","columns":["id"],"referenced_columns":[],"comment":""}],"triggers":[],"def":""},{"name":"public.products","type":"BASE TABLE","comment":"商品：社内全体で管理されている商品コードを格納","columns":[{"name":"id","type":"text","nullable":false,"default":null,"comment":""},{"name":"code","type":"text","nullable":false,"default":null,"comment":"商品コード；社内全体で管理されている"}],"indexes":[{"name":"products_pkey","def":"CREATE UNIQUE INDEX products_pkey ON public.products USING btree (id)","table":"public.products","columns":["id"],"comment":""},{"name":"products_code_key","def":"CREATE UNIQUE INDEX products_code_key ON public.products USING btree (code)","table":"public.products","columns":["code"],"comment":""}],"constraints":[{"name":"products_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.products","referenced_table":"","columns":["id"],"referenced_columns":[],"comment":""}],"triggers":[],"def":""},{"name":"public.books","type":"BASE TABLE","comment":"書籍","columns":[{"name":"id","type":"text","nullable":false,"default":null,"comment":""},{"name":"title","type":"text","nullable":false,"default":null,"comment":"書籍名"},{"name":"published_on","type":"timestamp(3) without time zone","nullable":false,"default":null,"comment":"出版日"},{"name":"price","type":"integer","nullable":false,"default":null,"comment":"価格"},{"name":"subtitle","type":"text","nullable":false,"default":null,"comment":"サブタイトル"},{"name":"publisher_id","type":"text","nullable":false,"default":null,"comment":"出版社ID"}],"indexes":[{"name":"books_pkey","def":"CREATE UNIQUE INDEX books_pkey ON public.books USING btree (id)","table":"public.books","columns":["id"],"comment":""}],"constraints":[{"name":"books_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.books","referenced_table":"","columns":["id"],"referenced_columns":[],"comment":""},{"name":"books_publisher_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (publisher_id) REFERENCES publishers(id) ON UPDATE CASCADE ON DELETE RESTRICT","table":"public.books","referenced_table":"publishers","columns":["publisher_id"],"referenced_columns":["id"],"comment":""}],"triggers":[],"def":""},{"name":"public.publishers","type":"BASE TABLE","comment":"出版社（管理者用アプリからのみ作成される）","columns":[{"name":"id","type":"text","nullable":false,"default":null,"comment":""},{"name":"name","type":"text","nullable":false,"default":null,"comment":"出版社名"}],"indexes":[{"name":"publishers_pkey","def":"CREATE UNIQUE INDEX publishers_pkey ON public.publishers USING btree (id)","table":"public.publishers","columns":["id"],"comment":""}],"constraints":[{"name":"publishers_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.publishers","referenced_table":"","columns":["id"],"referenced_columns":[],"comment":""}],"triggers":[],"def":""},{"name":"public.authors","type":"BASE TABLE","comment":"著者（書籍とは別に作成可能）","columns":[{"name":"id","type":"text","nullable":false,"default":null,"comment":""},{"name":"name","type":"text","nullable":false,"default":null,"comment":"著者名"}],"indexes":[{"name":"authors_pkey","def":"CREATE UNIQUE INDEX authors_pkey ON public.authors USING btree (id)","table":"public.authors","columns":["id"],"comment":""}],"constraints":[{"name":"authors_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.authors","referenced_table":"","columns":["id"],"referenced_columns":[],"comment":""}],"triggers":[],"def":""},{"name":"public.author_books","type":"BASE TABLE","comment":"著者と書籍の中間テーブル","columns":[{"name":"author_id","type":"text","nullable":false,"default":null,"comment":"著者ID"},{"name":"book_id","type":"text","nullable":false,"default":null,"comment":"書籍ID"}],"indexes":[{"name":"author_books_pkey","def":"CREATE UNIQUE INDEX author_books_pkey ON public.author_books USING btree (author_id, book_id)","table":"public.author_books","columns":["author_id","book_id"],"comment":""}],"constraints":[{"name":"author_books_book_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (book_id) REFERENCES books(id) ON UPDATE CASCADE ON DELETE RESTRICT","table":"public.author_books","referenced_table":"books","columns":["book_id"],"referenced_columns":["id"],"comment":""},{"name":"author_books_author_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (author_id) REFERENCES authors(id) ON UPDATE CASCADE ON DELETE RESTRICT","table":"public.author_books","referenced_table":"authors","columns":["author_id"],"referenced_columns":["id"],"comment":""},{"name":"author_books_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (author_id, book_id)","table":"public.author_books","referenced_table":"","columns":["author_id","book_id"],"referenced_columns":[],"comment":""}],"triggers":[],"def":""},{"name":"public.book_images","type":"BASE TABLE","comment":"書籍画像","columns":[{"name":"id","type":"text","nullable":false,"default":null,"comment":""},{"name":"url","type":"text","nullable":false,"default":null,"comment":"画像URL"},{"name":"book_id","type":"text","nullable":false,"default":null,"comment":"書籍ID"}],"indexes":[{"name":"book_images_pkey","def":"CREATE UNIQUE INDEX book_images_pkey ON public.book_images USING btree (id)","table":"public.book_images","columns":["id"],"comment":""}],"constraints":[{"name":"book_images_book_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (book_id) REFERENCES books(id) ON UPDATE CASCADE ON DELETE RESTRICT","table":"public.book_images","referenced_table":"books","columns":["book_id"],"referenced_columns":["id"],"comment":""},{"name":"book_images_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.book_images","referenced_table":"","columns":["id"],"referenced_columns":[],"comment":""}],"triggers":[],"def":""},{"name":"public.customers","type":"BASE TABLE","comment":"顧客","columns":[{"name":"id","type":"text","nullable":false,"default":null,"comment":""},{"name":"name","type":"text","nullable":false,"default":null,"comment":"顧客名"},{"name":"email","type":"text","nullable":false,"default":null,"comment":"メールアドレス"},{"name":"password","type":"text","nullable":false,"default":null,"comment":"パスワード（暗号化済み）"}],"indexes":[{"name":"customers_pkey","def":"CREATE UNIQUE INDEX customers_pkey ON public.customers USING btree (id)","table":"public.customers","columns":["id"],"comment":""}],"constraints":[{"name":"customers_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.customers","referenced_table":"","columns":["id"],"referenced_columns":[],"comment":""}],"triggers":[],"def":""},{"name":"public.orders","type":"BASE TABLE","comment":"注文：注文の確定ごとに作成される。請求処理は注文の重複がないかどうか確認されてから行われるため、必ずしも対応関係ではない。","columns":[{"name":"id","type":"text","nullable":false,"default":null,"comment":""},{"name":"customer_id","type":"text","nullable":false,"default":null,"comment":"顧客ID"}],"indexes":[{"name":"orders_pkey","def":"CREATE UNIQUE INDEX orders_pkey ON public.orders USING btree (id)","table":"public.orders","columns":["id"],"comment":""}],"constraints":[{"name":"orders_customer_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (customer_id) REFERENCES customers(id) ON UPDATE CASCADE ON DELETE RESTRICT","table":"public.orders","referenced_table":"customers","columns":["customer_id"],"referenced_columns":["id"],"comment":""},{"name":"orders_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.orders","referenced_table":"","columns":["id"],"referenced_columns":[],"comment":""}],"triggers":[],"def":""},{"name":"public.order_items","type":"BASE TABLE","comment":"注文明細","columns":[{"name":"id","type":"text","nullable":false,"default":null,"comment":""},{"name":"order_id","type":"text","nullable":false,"default":null,"comment":"注文ID"},{"name":"book_id","type":"text","nullable":false,"default":null,"comment":"書籍ID"},{"name":"quantity","type":"integer","nullable":false,"default":null,"comment":"数量"},{"name":"price","type":"integer","nullable":false,"default":null,"comment":"価格"}],"indexes":[{"name":"order_items_pkey","def":"CREATE UNIQUE INDEX order_items_pkey ON public.order_items USING btree (id)","table":"public.order_items","columns":["id"],"comment":""}],"constraints":[{"name":"order_items_book_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (book_id) REFERENCES books(id) ON UPDATE CASCADE ON DELETE RESTRICT","table":"public.order_items","referenced_table":"books","columns":["book_id"],"referenced_columns":["id"],"comment":""},{"name":"order_items_order_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (order_id) REFERENCES orders(id) ON UPDATE CASCADE ON DELETE RESTRICT","table":"public.order_items","referenced_table":"orders","columns":["order_id"],"referenced_columns":["id"],"comment":""},{"name":"order_items_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.order_items","referenced_table":"","columns":["id"],"referenced_columns":[],"comment":""}],"triggers":[],"def":""},{"name":"public.shipping_addresses","type":"BASE TABLE","comment":"配送先","columns":[{"name":"id","type":"text","nullable":false,"default":null,"comment":""},{"name":"customer_id","type":"text","nullable":false,"default":null,"comment":"顧客ID"},{"name":"name","type":"text","nullable":false,"default":null,"comment":"名前"},{"name":"postal_code","type":"text","nullable":false,"default":null,"comment":"郵便番号"},{"name":"address","type":"text","nullable":false,"default":null,"comment":"住所"},{"name":"tel","type":"text","nullable":false,"default":null,"comment":"電話番号"}],"indexes":[{"name":"shipping_addresses_pkey","def":"CREATE UNIQUE INDEX shipping_addresses_pkey ON public.shipping_addresses USING btree (id)","table":"public.shipping_addresses","columns":["id"],"comment":""}],"constraints":[{"name":"shipping_addresses_customer_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (customer_id) REFERENCES customers(id) ON UPDATE CASCADE ON DELETE RESTRICT","table":"public.shipping_addresses","referenced_table":"customers","columns":["customer_id"],"referenced_columns":["id"],"comment":""},{"name":"shipping_addresses_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.shipping_addresses","referenced_table":"","columns":["id"],"referenced_columns":[],"comment":""}],"triggers":[],"def":""}],"relations":[{"table":"public.books","columns":["publisher_id"],"cardinality":"Zero or more","parent_table":"public.publishers","parent_columns":["id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (publisher_id) REFERENCES publishers(id) ON UPDATE CASCADE ON DELETE RESTRICT","virtual":false},{"table":"public.author_books","columns":["book_id"],"cardinality":"Zero or more","parent_table":"public.books","parent_columns":["id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (book_id) REFERENCES books(id) ON UPDATE CASCADE ON DELETE RESTRICT","virtual":false},{"table":"public.author_books","columns":["author_id"],"cardinality":"Zero or more","parent_table":"public.authors","parent_columns":["id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (author_id) REFERENCES authors(id) ON UPDATE CASCADE ON DELETE RESTRICT","virtual":false},{"table":"public.book_images","columns":["book_id"],"cardinality":"Zero or more","parent_table":"public.books","parent_columns":["id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (book_id) REFERENCES books(id) ON UPDATE CASCADE ON DELETE RESTRICT","virtual":false},{"table":"public.orders","columns":["customer_id"],"cardinality":"Zero or more","parent_table":"public.customers","parent_columns":["id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (customer_id) REFERENCES customers(id) ON UPDATE CASCADE ON DELETE RESTRICT","virtual":false},{"table":"public.order_items","columns":["book_id"],"cardinality":"Zero or more","parent_table":"public.books","parent_columns":["id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (book_id) REFERENCES books(id) ON UPDATE CASCADE ON DELETE RESTRICT","virtual":false},{"table":"public.order_items","columns":["order_id"],"cardinality":"Zero or more","parent_table":"public.orders","parent_columns":["id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (order_id) REFERENCES orders(id) ON UPDATE CASCADE ON DELETE RESTRICT","virtual":false},{"table":"public.shipping_addresses","columns":["customer_id"],"cardinality":"Zero or more","parent_table":"public.customers","parent_columns":["id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (customer_id) REFERENCES customers(id) ON UPDATE CASCADE ON DELETE RESTRICT","virtual":false}],"functions":[],"driver":{"name":"postgres","database_version":"PostgreSQL 16.1 (Debian 16.1-1.pgdg120+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit","meta":{"current_schema":"public","search_paths":["\"$user\"","public"],"dict":{"Functions":"Stored procedures and functions"}}},"viewpoints":[{"name":"書籍の追加","desc":"書籍を追加する際に関連するテーブルのまとまり","tables":["public.books","public.products","public.publishers","public.authors","public.author_books","public.book_images"]},{"name":"顧客の追加","desc":"顧客を追加する際に関連するテーブルのまとまり","tables":["public.customers"]},{"name":"配送先の追加","desc":"配送先を追加する際に関連するテーブルのまとまり","tables":["public.shipping_addresses","public.customers"]},{"name":"書籍の購入","desc":"書籍を購入する際に関連するテーブルのまとまり。 顧客が購入できるためには、配送先が設定される必要がある。 配送時に参照される製品コードはproductsテーブルから取得される。","tables":["public.books","public.products","public.customers","public.shipping_addresses","public.orders","public.order_items"]}]}
